<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Verify Email - Meeza Dashboard</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #007bff; /* Blue background from screenshot */
        }
        
        #api {
            background: transparent !important;
            border: none !important;
            box-shadow: none !important;
            padding: 0 !important;
            margin: 0 !important;
            animation: none !important;
        }
        
        #api .intro, 
        #api .heading /* Hide default B2C heading if using custom one */
        {
            display: none !important;
        }

        .custom-page-title {
            font-size: 1.5rem; 
            font-weight: 600;
            color: #374151; 
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .page-icon {
            width: 4rem; 
            height: 4rem; 
            margin: 0 auto 1rem auto; 
            color: #D1D5DB;
        }
        
        #api .attrEntry {
            margin-bottom: 1rem !important;
        }
        
        #api .attrEntry label {
            display: block !important;
            margin-bottom: 0.625rem !important;
            font-weight: 500 !important;
            color: #1C2434 !important;
            font-size: 0.875rem !important;
        }

        #api input#email,
        #api input#emailVerificationCode,
        #api input.textInput[type="email"], /* Broader selector for email input */
        #api input.textInput[type="text"] /* For verification code if it's text */
        {
            width: 100% !important;
            padding: 1rem 1.5rem !important;
            border: 1px solid #E0E0E0 !important;
            border-radius: 0.5rem !important;
            background-color: transparent !important;
            outline: none !important;
            transition: all 0.2s !important;
            font-size: 1rem !important;
            color: #1C2434 !important;
            box-sizing: border-box !important; /* Important for padding and border */
        }
        
        #api input#email:focus,
        #api input#emailVerificationCode:focus,
        #api input.textInput[type="email"]:focus,
        #api input.textInput[type="text"]:focus
        {
            border-color: #3B82F6 !important;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1) !important;
        }
        
        #api input#email::placeholder,
        #api input#emailVerificationCode::placeholder,
        #api input.textInput[type="email"]::placeholder,
        #api input.textInput[type="text"]::placeholder 
        {
            color: #9CA3AF !important;
        }

        #api .error.itemLevel {
            background-color: transparent !important;
            border: none !important;
            padding: 0.25rem 0 0 0 !important;
            margin-bottom: 0.5rem !important;
            color: #C53030 !important; 
            font-size: 0.75rem !important;
            /* display: none;  Let B2C handle visibility, just style it */
        }

        #api .error.itemLevel.show { /* B2C might add .show class */
            display: block !important;
        }
        
        #api .attrEntry .error.itemLevel.show + input.textInput,
        #api .attrEntry .error.itemLevel + input.textInput /* If error is shown before interaction */
        {
            border-color: #FC8181 !important; 
            background-color: #FFF5F5 !important;
        }

        #api .error.pageLevel {
            background-color: #FED7D7 !important;
            border: 1px solid #FC8181 !important;
            border-radius: 0.375rem !important;
            padding: 0.75rem 1rem !important;
            margin-bottom: 1.5rem !important;
            color: #C53030 !important;
            font-size: 0.875rem !important;
        }
        
        #api .buttons {
            margin-top: 1.5rem !important;
            margin-bottom: 1.5rem !important;
        }
        
        #api button#continue, 
        #api button#emailVerificationControl_but_send_code,
        #api button#emailVerificationControl_but_verify_code,
        #api button.verificationButton, /* Generic verification button class */
        #api button[type="submit"] /* Catch-all for submit buttons */
        { 
            width: 100% !important;
            background-color: #7d0848ff !important;
            color: white !important;
            border: none !important;
            padding: 1rem !important;
            border-radius: 0.5rem !important;
            font-size: 1rem !important;
            font-weight: 500 !important;
            cursor: pointer !important;
            transition: all 0.2s !important;
            margin-bottom: 0.75rem !important; 
        }
        
        #api button#continue:hover, 
        #api button#emailVerificationControl_but_send_code:hover,
        #api button#emailVerificationControl_but_verify_code:hover,
        #api button.verificationButton:hover,
        #api button[type="submit"]:hover
        {
            background-color: #5a0634 !important;
            transform: translateY(-1px) !important;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06) !important;
        }

        #api button#cancel {
            width: auto !important; 
            background-color: transparent !important;
            color: #6B7280 !important; 
            border: none !important;
            padding: 0.5rem 0 !important; 
            font-size: 0.875rem !important;
            font-weight: 500 !important;
            cursor: pointer !important;
            transition: color 0.2s !important;
            display: flex !important; 
            align-items: center !important;
            margin-bottom: 0 !important; /* Reset margin from broader button rules */
        }

        #api button#cancel:hover {
            color: #1F2937 !important; 
        }

        #api button#cancel svg {
            margin-right: 0.5rem !important;
            width: 1rem !important; 
            height: 1rem !important;
        }
    </style>
</head>
<body class="flex items-center justify-center min-h-screen p-4">
    <img data-tenant-branding-background="true" class="hidden" />
    <img data-tenant-branding-logo="true" alt="Company Logo" class="hidden" />
    
    <div class="bg-white rounded-lg shadow-xl w-full max-w-md p-8 sm:p-10">
        <div id="customCancelButtonContainer" class="mb-6 h-8"> </div>

        <svg class="page-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M21 7.5l-9-5.25L3 7.5m18 0l-9 5.25m9-5.25v9l-9 5.25M3 7.5l9 5.25M3 7.5v9l9 5.25m0-9v9" />
        </svg>

        <h1 id="customPageTitle" class="custom-page-title">Verify Your Email</h1> 
        
        <div id="api" data-name="SelfAsserted" dir="ltr">
            </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function () {
        const apiDiv = document.getElementById('api');
        if (!apiDiv) {
            console.error("Azure B2C #api container not found on DOMContentLoaded. Styling may fail.");
            return;
        }
        const customCancelContainer = document.getElementById('customCancelButtonContainer');
        const customPageTitle = document.getElementById('customPageTitle');

        // Use a WeakSet to keep track of elements for which listeners have been added
        const initializedElements = new WeakSet();

        function applyElementStyles(element, baseStyles, hoverStyles, focusStyles) {
            if (!element) return;

            // Apply base styles
            for (const prop in baseStyles) {
                element.style.setProperty(prop, baseStyles[prop], 'important');
            }

            // Add event listeners only once
            if (!initializedElements.has(element)) {
                if (hoverStyles) {
                    element.addEventListener('mouseenter', () => {
                        for (const prop in hoverStyles.enter) {
                            element.style.setProperty(prop, hoverStyles.enter[prop], 'important');
                        }
                    });
                    element.addEventListener('mouseleave', () => {
                        for (const prop in hoverStyles.leave) {
                            element.style.setProperty(prop, hoverStyles.leave[prop], 'important');
                        }
                         // Re-apply base background if not in focus
                        if (baseStyles['background-color'] && !(document.activeElement === element && focusStyles)) {
                             element.style.setProperty('background-color', baseStyles['background-color'], 'important');
                        }
                    });
                }
                if (focusStyles) {
                    element.addEventListener('focus', () => {
                        for (const prop in focusStyles) {
                            element.style.setProperty(prop, focusStyles[prop], 'important');
                        }
                    });
                    element.addEventListener('blur', () => { // Reset to base styles on blur
                        for (const prop in baseStyles) {
                             // Don't reset border-color if it was set by baseStyles on focus (e.g. error state)
                            if (prop === 'border-color' && baseStyles[prop] !== focusStyles[prop]) {
                                element.style.setProperty(prop, baseStyles[prop], 'important');
                            } else if (prop !== 'border-color') {
                                element.style.setProperty(prop, baseStyles[prop], 'important');
                            }
                        }
                        // Specifically reset box-shadow if it was part of focus
                        if(focusStyles['box-shadow']){
                            element.style.setProperty('box-shadow', 'none', 'important');
                        }
                         // Re-apply base border if different from focus
                        if(baseStyles['border'] && focusStyles['border-color'] && baseStyles['border'].split(' ')[2] !== focusStyles['border-color']){
                            element.style.setProperty('border', baseStyles['border'], 'important');
                        }
                    });
                }
                initializedElements.add(element);
            }
        }


        function forceApplyPageStyling() {
            console.log('forceApplyPageStyling triggered');

            // Email Input
            const emailInput = apiDiv.querySelector('input#email, input.textInput[type="email"]'); // More general
            if (emailInput) {
                console.log('Email input found:', emailInput);
                applyElementStyles(emailInput,
                    { /* base */
                        'width': '100%', 'padding': '1rem 1.5rem', 'border': '1px solid #E0E0E0',
                        'border-radius': '0.5rem', 'background-color': 'transparent', 'outline': 'none',
                        'transition': 'all 0.2s', 'font-size': '1rem', 'color': '#1C2434', 'box-sizing': 'border-box'
                    },
                    null, /* no hover specific for input, handled by focus */
                    { /* focus */
                        'border-color': '#3B82F6', 
                        'box-shadow': '0 0 0 3px rgba(59, 130, 246, 0.1)'
                    }
                );
            } else { console.log('Email input not found.'); }

            // Verification Code Input (if present)
            const verificationCodeInput = apiDiv.querySelector('input#emailVerificationCode, input.textInput[type="text"]:not(#email)');
            if (verificationCodeInput) {
                 console.log('Verification code input found:', verificationCodeInput);
                 applyElementStyles(verificationCodeInput,
                    { /* base */
                        'width': '100%', 'padding': '1rem 1.5rem', 'border': '1px solid #E0E0E0',
                        'border-radius': '0.5rem', 'background-color': 'transparent', 'outline': 'none',
                        'transition': 'all 0.2s', 'font-size': '1rem', 'color': '#1C2434', 'box-sizing': 'border-box'
                    },
                    null,
                    { /* focus */
                        'border-color': '#3B82F6',
                        'box-shadow': '0 0 0 3px rgba(59, 130, 246, 0.1)'
                    }
                );
            } else { console.log('Verification code input not found.'); }


            // Buttons (Send Code, Verify, Continue)
            const primaryButtonSelectors = [
                'button#emailVerificationControl_but_send_code',
                'button#emailVerificationControl_but_verify_code',
                'button#continue', // General B2C continue
                'button.verificationButton', // Class sometimes used
                'div.buttons > button[type="submit"]' // More generic submit
            ].join(', ');

            const primaryButtons = apiDiv.querySelectorAll(primaryButtonSelectors);
            primaryButtons.forEach(button => {
                // Avoid re-styling the cancel button if it gets caught by a generic selector
                if(button.id === 'cancel') return;

                console.log('Primary button found:', button.id || button.className);
                applyElementStyles(button,
                    { /* base */
                        'width': '100%', 'background-color': '#7d0848ff', 'color': 'white', 'border': 'none',
                        'padding': '1rem', 'border-radius': '0.5rem', 'font-size': '1rem',
                        'font-weight': '500', 'cursor': 'pointer', 'transition': 'all 0.2s', 'margin-bottom': '0.75rem'
                    },
                    { /* hover */
                        enter: { 'background-color': '#5a0634', 'transform': 'translateY(-1px)', 'box-shadow': '0 4px 6px -1px rgba(0,0,0,0.1), 0 2px 4px -1px rgba(0,0,0,0.06)' },
                        leave: { 'background-color': '#7d0848ff', 'transform': 'translateY(0px)', 'box-shadow': 'none' }
                    },
                    null /* no specific focus styles for button beyond hover/active */
                );
            });
             if (primaryButtons.length === 0) { console.log('No primary buttons found with selectors.');}


            // Cancel Button
            const b2cCancelButton = apiDiv.querySelector('button#cancel');
            if (b2cCancelButton && customCancelContainer && !customCancelContainer.contains(b2cCancelButton)) {
                console.log('Cancel button found, moving and styling.');
                if (!b2cCancelButton.querySelector('svg')) {
                    const svgIcon = document.createElementNS("http://www.w3.org/2000/svg", "svg");
                    svgIcon.setAttribute("class", "h-4 w-4 mr-2"); // Tailwind classes
                    svgIcon.setAttribute("fill", "none");
                    svgIcon.setAttribute("viewBox", "0 0 24 24");
                    svgIcon.setAttribute("stroke", "currentColor");
                    svgIcon.setAttribute("stroke-width", "2");
                    svgIcon.innerHTML = '<path stroke-linecap="round" stroke-linejoin="round" d="M15 19l-7-7 7-7" />';
                    b2cCancelButton.insertBefore(svgIcon, b2cCancelButton.firstChild);
                }
                // Apply base styles for cancel button directly or via CSS
                 applyElementStyles(b2cCancelButton,
                    { /* base */
                        'width': 'auto', 'background-color': 'transparent', 'color': '#6B7280', 'border': 'none',
                        'padding': '0.5rem 0', 'font-size': '0.875rem', 'font-weight': '500',
                        'cursor': 'pointer', 'transition': 'color 0.2s', 'display': 'flex', 'align-items': 'center',
                        'margin-bottom': '0'
                    },
                    { /* hover */
                        enter: { 'color': '#1F2937' },
                        leave: { 'color': '#6B7280' }
                    },
                    null
                );
                customCancelContainer.appendChild(b2cCancelButton);
            } else if (b2cCancelButton && customCancelContainer.contains(b2cCancelButton)) {
                 // Already moved, just ensure styles if observer re-fires
                 console.log('Cancel button already in custom container, ensuring styles.');
                 applyElementStyles(b2cCancelButton, { /* base styles as above */}, { /* hover styles as above */ }, null);
            } else { console.log('B2C Cancel button not found or custom container missing.'); }

            // Page Title Logic
            const b2cHeadingElement = apiDiv.querySelector('.heading h1, .intro h2'); // Common B2C heading selectors
            if (customPageTitle) {
                if (b2cHeadingElement && b2cHeadingElement.innerText.trim() !== '') {
                    customPageTitle.style.display = 'none';
                    console.log('B2C heading found, hiding custom title. B2C Title:', b2cHeadingElement.innerText);
                } else {
                    customPageTitle.style.display = 'block';
                    console.log('No B2C heading found or empty, showing custom title.');
                }
            }
        }

        // Initial attempt to style, elements might not be ready.
        forceApplyPageStyling(); 

        const observer = new MutationObserver(function (mutationsList, observer) {
            console.log('MutationObserver detected DOM changes.');
            // It's crucial to check if the #api div still exists, B2C could potentially replace it.
            if (!document.body.contains(apiDiv)) {
                console.error("#api div was removed from DOM. Stopping observer.");
                observer.disconnect();
                return;
            }
            forceApplyPageStyling();
        });

        observer.observe(apiDiv, {
            childList: true, // Detect when children are added or removed from #api
            subtree: true    // Detect changes in descendants of #api as well
            // attributes: true, // Optional: if B2C changes classes/attributes that break your styles
            // attributeFilter: ['style', 'class'] // Optional: if attributes=true, only watch specific ones
        });

        // Optional: A safety net interval if elements appear very late and somehow bypass the observer
        // Use with caution as it can be performance-intensive.
        /*
        let retryCount = 0;
        const retryInterval = setInterval(() => {
            console.log('Retry interval styling attempt...');
            forceApplyPageStyling();
            retryCount++;
            if (retryCount > 15) { // Stop after ~3 seconds
                clearInterval(retryInterval);
                console.log('Stopped retry interval.');
            }
        }, 200);
        */
    });
    </script>
</body>
</html>
